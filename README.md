# AI Interviewer Platform - Multi-Tenant SaaS

A production-grade, multi-tenant AI Interviewer platform designed for colleges and training institutions. It enables organizations to conduct automated, AI-driven mock interviews for students with ultra-low latency voice interaction, real-time transcription, and detailed performance reports.

## ğŸš€ Key Features

*   **Multi-Tenant Architecture**: Single codebase supporting multiple isolated organizations (colleges) via dynamic routing (`/[orgSlug]`).
*   **Advanced AI Voice Architecture (Half-Duplex)**:
    *   **CheatingDaddy Architecture**: Implements strict turn-taking state machine (KICKOFF â†’ MODEL_SPEAKING â†’ LISTENING â†’ COMMITTING) to prevent interruptions and repeats.
    *   **Low Latency**: Optimized VAD (Voice Activity Detection) with 1.5s pause tolerance and sub-500ms response times.
    *   **Context Aware**: "Sliding Window" compression for long-duration coherence.
    *   **Resilient Connectivity**: Auto-reconnects on network drops or idle timeouts.
*   **Role-Based Access Control (RBAC)**:
    *   **Platform Owner**: Global admin managing all organizations and system settings.
    *   **Org Super Admin**: Manages a specific organization, staff, and students.
    *   **Staff/Faculty**: Monitors student progress and reviews reports (Org-scoped).
    *   **Students**: Takes interviews and views their own reports (Org-scoped).
*   **Analytics & Reporting**:
    *   Detailed feedback reports generated by AI.
    *   Scoring mechanism (0-100).
    *   Strengths & Weaknesses analysis.
    *   Organization-wide performance dashboards.

## ğŸ›  Tech Stack

*   **Framework**: Next.js 14 (App Router)
*   **Language**: TypeScript
*   **Styling**: Tailwind CSS, shadcn/ui
*   **Backend/DB**: Firebase (Auth, Firestore, Storage)
*   **AI**: Google Gemini Multimodal Live API
*   **Audio Pipeline**: Web Audio API + AudioWorklet (Streaming PCM16)
*   **State Management**: Zustand (+ Custom Turn Controller)
*   **Deployment**: Vercel (Edge/Serverless optimized)

## ğŸ“‚ Project Structure

```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ [orgSlug]/              # Organization-scoped routes
â”‚   â”‚   â”œâ”€â”€ admin/              # Org Admin Portal
â”‚   â”‚   â”œâ”€â”€ student/            # Student Portal (Dashboard, Room, Report)
â”‚   â”œâ”€â”€ api/                    # API Routes (Force Dynamic for Vercel)
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ interview/              # Interview Room Components (Timer, Visualizer)
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ audio/                  # Audio Pipeline (Recorder, TurnController, VAD)
â”‚   â”œâ”€â”€ firebase/               # Firebase Admin & Client SDKs
â”‚   â”œâ”€â”€ gemini/                 # Gemini Live Client
â””â”€â”€ store/                      # Global State
```

## ğŸ—º Application Routes

### Organization Portal (`/[orgSlug]`)
*   `/[orgSlug]/login`: Unified login.
*   `/[orgSlug]/student/room/[interviewId]`: **Live Interview Room** (Core Experience).

## ğŸš¦ Getting Started & Deployment

### Environment Setup (Vercel Production)

For production deployment on Vercel, you need robust server-side credentials. See **[VERCEL_SETUP.md](./VERCEL_SETUP.md)** for the complete guide.

Required Environment Variables:

```env
# Client-Side (Public)
NEXT_PUBLIC_FIREBASE_API_KEY=...
NEXT_PUBLIC_FIREBASE_PROJECT_ID=...
# ... other standard Firebase vars ...

# Server-Side (Secure)
FIREBASE_CLIENT_EMAIL=...
FIREBASE_PRIVATE_KEY=...  # Full private key with newlines
ENCRYPTION_KEY=...        # 32-byte hex key for API key security
```

### Running Locally

```bash
npm install
npm run dev
```

Visit `http://localhost:3000`.

## ğŸ” Security & Architecture

*   **Turn-Taking State Machine**: Prevents "talking over" by strictly gating microphone input during model speech.
*   **Audio Deadlock Prevention**: Fallback logic ensures turns complete even if transcription fails (Audio-only fallback).
*   **Secure API Keys**: User API keys are AES-256-GCM encrypted at rest.
*   **Session Persistence**: Auto-reconnect logic handles mobile network switches or long idle times.

## ğŸ§ª Testing Flow

1.  **Create Platform Owner**: Go to `/admin/login`, click "Setup Platform", enter key `PLATFORM2024`.
2.  **Create Organization**: Dashboard â†’ Create "Demo College".
3.  **Take Interview**: Log in as Student â†’ Start Interview. Speak naturally.
    *   *Test Interruption*: Try to interrupt; system handles it gracefully.
    *   *Test Silence*: Pause for 2 seconds; system detects end-of-turn automatically.
